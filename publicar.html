<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Publicar Item — Achados & Perdidos Angola</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?
family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/lucide@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
body{ font-family:'Inter',sans-serif; background:radial-gradient(circle
at top left,#0a192f,#112240,#0a192f); background-size:200% 200%;
animation:movimento 10s ease infinite; color:#e6f0ff }
@keyframes movimento{0%{background-position:0% 0%}50%{backgroundposition:100% 50%}100%{background-position:0% 0%}}
header{ backdrop-filter: blur(6px); background: rgba(10,25,47,0.85);
transition:0.4s }
.card{ background: rgba(255,255,255,0.06); backdrop-filter: blur(8px);
border:1px solid rgba(255,255,255,0.06); border-radius:12px }
</style>
</head>
<body>
<header class="text-white p-4 fixed w-full top-0 left-0 z-40">
<div class="max-w-6xl mx-auto flex items-center justify-between">
<a href="index.html" class="flex items-center gap-2 font-bold textxl"><i data-lucide="search" class="w-6 h-6"></i> Achados & Perdidos</a>
<nav class="flex items-center gap-6 text-sm font-medium"><a
href="index.html" class="hover:underline"> Início</a><a href="feed.html"
class="hover:underline"> Feed</a></nav>
</div>

</header>
<main class="max-w-3xl mx-auto p-6 mt-28">
<div class="card p-6">
<h1 class="text-2xl font-bold mb-4 text-blue-100">Publicar Item</h1>
<form id="form-publicar" class="space-y-4">
<input id="titulo" type="text" placeholder="Título"
class="w-full p-3 rounded border dark:bg-gray-700" required />
<textarea id="descricao" rows="3" placeholder="Descrição (opcional)"
class="w-full p-3 rounded border dark:bg-gray-700"></textarea>
<div class="grid sm:grid-cols-2 gap-3">
<select id="tipo" class="p-3 rounded border dark:bggray-700"><option value="perdido">Perdido</option><option
value="encontrado">Encontrado</option></select>
<select id="categoria" class="p-3 rounded border dark:bggray-700"><option>Documentos</option><option>Carteira</
option><option>Telemóvel</option><option>Chaves</option><option>Outros</
option></select>
</div>
<input id="foto" type="file" accept="image/*" class="w-full p-3
rounded border dark:bg-gray-700" required />
<input id="contacto" type="tel" placeholder="Contacto (WhatsApp)"
class="w-full p-3 rounded border dark:bg-gray-700" required />
<button type="submit" class="w-full bg-blue-600 text-white py-3
rounded font-semibold">Publicar</button>
</form>
</div>
</main>
<footer class="navy text-white p-6 text-center mt-8">© <span id="ano"></
span> Achados & Perdidos Angola</footer>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/
firebase-app.js";
import { getFirestore, addDoc, collection, serverTimestamp } from
"https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/
firebasejs/9.22.2/firebase-auth.js";
import { firebaseConfig } from './firebase-config.js';
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);
const form = document.getElementById('form-publicar');
const cloudName = 'dyylw9hjm';
const uploadPreset = 'ml_default';
onAuthStateChanged(auth, user=>{ if(!user){ Swal.fire({ icon:'warning',
title:'Sessão necessária', html:'<p>Precisas de iniciar sessão para

publicar.</p><button id="go-login" class="swal2-confirm swal2-styled"
style="background:#0a192f"> Ir para Login</button>',
showConfirmButton:false, didOpen: ()=>{ document.getElementById('gologin').addEventListener('click', ()=>{ Swal.close();
window.location.href='index.html#login' }) } }) } });
form.addEventListener('submit', async (e)=>{
e.preventDefault();
const user = auth.currentUser; if(!user) return;
const titulo = document.getElementById('titulo').value.trim();
const descricao = document.getElementById('descricao').value.trim();
const tipo = document.getElementById('tipo').value;
const categoria = document.getElementById('categoria').value;
const contacto = document.getElementById('contacto').value.trim();
const foto = document.getElementById('foto').files[0];
if(!foto) return Swal.fire(' ','Seleciona uma imagem.','warning');
Swal.fire({ title:'A publicar...', allowOutsideClick:false, didOpen:
()=>Swal.showLoading() });
try{
const fd = new FormData(); fd.append('file', foto);
fd.append('upload_preset', uploadPreset);
const up = await fetch(`https://api.cloudinary.com/v1_1/${cloudName}/
image/upload`, { method:'POST', body:fd });
if(!up.ok) throw new Error('Erro upload'); const img = await
up.json();
await addDoc(collection(db,'items'), { uid: user.uid, titulo,
descricao, tipo, categoria, contacto, fotoURL: img.secure_url, created_at:
serverTimestamp() });
Swal.fire(' ','Publicado com sucesso!','success'); form.reset();
setTimeout(()=> location.href='feed.html',1200);
}catch(err){ console.error(err); Swal.fire(' ','Erro ao
publicar.','error') }
});
document.getElementById('ano').textContent = new Date().getFullYear();
lucide.createIcons();
</script>
</body>
</html>
