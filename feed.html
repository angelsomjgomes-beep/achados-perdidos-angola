<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Feed — Achados & Perdidos Angola</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?
family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/lucide@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
body{ font-family:'Inter',sans-serif; background:radial-gradient(circle
at top left,#0a192f,#112240,#0a192f); background-size:200% 200%;
animation:movimento 10s ease infinite; color:#e6f0ff }
@keyframes movimento{0%{background-position:0% 0%}50%{backgroundposition:100% 50%}100%{background-position:0% 0%}}
header{ backdrop-filter: blur(6px); background: rgba(10,25,47,0.85);
transition:0.4s }
header.scrolled{ background: rgba(10,25,47,0.95) }
.card{ background: rgba(255,255,255,0.06); backdrop-filter: blur(8px);
border:1px solid rgba(255,255,255,0.06); border-radius:12px }
.badge{ background:#0a192f; color:white; font-size:.75rem; padding:.
25rem .5rem; border-radius:9999px }
.float-btn{ position:fixed; bottom:20px; right:20px; background:#2563eb;
color:white; padding:14px; border-radius:999px; font-size:18px; box-shadow:0
8px 20px rgba(37,99,235,0.25); z-index:50 }
.fade-in{ opacity:0; transform:scale(.98); transition:opacity .45s ease,
transform .35s ease }
.fade-in.visible{ opacity:1; transform:scale(1) }
</style>
</head>
<body>
<header class="text-white p-4 fixed w-full top-0 left-0 z-40">
<div class="max-w-6xl mx-auto flex items-center justify-between">
<a href="index.html" class="flex items-center gap-2 font-bold textxl"><i data-lucide="search" class="w-6 h-6"></i> Achados & Perdidos</a>
<nav class="flex items-center gap-6 text-sm font-medium">
<a href="index.html" class="hover:underline"> Início</a>
<a href="feed.html" class="underline font-semibold"> Feed</a>
<a href="publicar.html" class="hover:underline"> Publicar</a>
</nav>
</div>
</header>
<main class="max-w-6xl mx-auto p-6 mt-28">

<div class="flex items-center justify-between mb-6 gap-4">
<input id="search" type="text" placeholder=" Procurar por título ou
descrição..." class="flex-1 p-3 rounded border dark:bg-gray-700" />
<select id="filtro" class="p-3 rounded border dark:bg-gray-700">
<option value="todos">Todas categorias</option>
<option value="Documentos">Documentos</option>
<option value="Carteira">Carteira</option>
<option value="Telemóvel">Telemóvel</option>
<option value="Chaves">Chaves</option>
<option value="Outros">Outros</option>
</select>
</div>
<div id="feed" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
<p id="sem-itens" class="hidden text-center text-gray-300 mt-6">Nenhum
item encontrado </p>
</main>
<a href="publicar.html" class="float-btn" aria-label="Publicar"> </a>
<footer class="navy text-white p-6 text-center mt-8">© <span id="ano"></
span> Achados & Perdidos Angola</footer>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/
firebase-app.js";
import { getFirestore, collection, query, orderBy, getDocs } from
"https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/
firebasejs/9.22.2/firebase-auth.js";
import { firebaseConfig } from './firebase-config.js';
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);
const feedEl = document.getElementById('feed');
const semItens = document.getElementById('sem-itens');
const search = document.getElementById('search');
const filtro = document.getElementById('filtro');
let todos = [];
let userId = null;
async function carregar(){
Swal.fire({ title:'A carregar...', allowOutsideClick:false, didOpen:
()=>Swal.showLoading() });
try{
const q = query(collection(db,'items'),
orderBy('created_at','desc'));
const snap = await getDocs(q);

Swal.close();
todos = [];
snap.forEach(d=> todos.push({ id:d.id, ...d.data() }));
render();
}catch(e){ Swal.fire(' Erro','Não foi possível carregar o
feed.','error'); console.error(e); }
}
function render(){
feedEl.innerHTML = '';
const termo = (search.value||'').toLowerCase();
const cat = filtro.value;
let filtrados = todos.filter(it=> (cat==='todos'||it.categoria===cat)
&& (it.titulo.toLowerCase().includes(termo) ||
(it.descricao||'').toLowerCase().includes(termo)));
if(filtrados.length===0){ semItens.classList.remove('hidden');
return; } else semItens.classList.add('hidden');
// ordenar meus itens primeiro
filtrados.sort((a,b)=> (a.uid===userId? -1:1));
filtrados.forEach((it,i)=>{
const card = document.createElement('div');
const tone = it.tipo==='encontrado' ? 'bg-green-50/30' : 'bgred-50/20';
card.className = `card fade-in ${tone} p-4`;
card.innerHTML = `
${it.fotoURL? `<img src="${it.fotoURL}" class="w-full h-44 objectcover rounded-lg mb-3">`: ''}
 <div class="flex justify-between items-center">
 <h3 class="text-lg font-semibold">${it.titulo}</h3>
${it.uid===userId? `<span class="badge">Publicado por mim</
span>` : ''}
 </div>
 <p class="text-sm text-gray-300">${it.categoria} • ${it.tipo}</p>
 <p class="mt-2 text-sm">${it.descricao||''}</p>
 <div class="mt-4 flex justify-between items-center">
 <a href="https://wa.me/${it.contacto||''}" target="_blank"
class="px-3 py-1 text-sm bg-green-600 hover:bg-green-700 text-white rounded">
 Contactar</a>
 <button class="reportar text-xs text-red-400 hover:underline">
Reportar</button>
 </div>
 `;
feedEl.appendChild(card);
setTimeout(()=> card.classList.add('visible'), 80*i);
card.querySelector('.reportar').addEventListener('click', ()=>
Swal.fire(' ','Funcionalidade de reportar em desenvolvimento.','info'));
});
}

search.addEventListener('input', render);
filtro.addEventListener('change', render);
onAuthStateChanged(auth, user=>{ userId = user? user.uid: null;
carregar(); });
document.getElementById('ano').textContent = new Date().getFullYear();
lucide.createIcons();
</script>
</body>
</html>


